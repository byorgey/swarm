version: 1
name: Test world DSL
description: foo
robots:
  - name: base
    loc: [0,0]
    dir: [1,0]
    devices:
      - 3D printer
      - logger
      - treads
      - grabber
world:
  dsl: |
    let pn0 = perlin seed 6 0.05 0.6,
        pn1 = perlin (seed + 1) 6 0.05 0.6,
        pn2 = perlin (seed + 2) 6 0.05 0.6,
        cl  = perlin seed 4 0.08 0.5,
        big = pn0 > 0.0,
        hard = pn1 > 0.0,
        artificial = pn2 > 0.0,
        small = not big,
        soft = not hard,
        natural = not artificial
    in
    overlay
    [ mask (big && hard && artificial)
        (if (cl > 0.85) then {stone, copper ore} else {stone})
    , mask (big && hard && natural)
      ( overlay
        [ {grass}
        , mask (cl > 0.0) (if (hash % 30 == 1) then {dirt, LaTeX} else {dirt, tree})
        , mask (hash % 30 == 0) {stone, boulder}
        , mask (cl > 0.5) {stone, mountain}
        ]
      )
    , mask (big && soft && natural)
      ( overlay
        [ {dirt, water}
        , mask ((x + y) % 2 == 0) {dirt, wavy water}
        , mask (abs pn1 < 0.1) {dirt, sand}
        ]
      )
    ]
    -- if p > 0.0 then {dirt, flower} else {stone}

    --      [ if (x + y >= 2) then c else {dirt}
    --      , if (x < (-5)) then ({stone} <> {stone, flower}) else {dirt}
    --      ]
